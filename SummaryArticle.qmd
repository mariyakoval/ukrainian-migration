---
format: html
  # pdf:
  #   fontsize: 11pt 
  #   geometry: top=2cm, bottom=2.5cm, left=2cm, right=2cm
editor: 
  markdown: 
    wrap: 72
---

\begin{center}
\vspace*{-1cm}

{\LARGE \textbf{Path of Resilience: Job-Seeking Behavior of Ukrainian Refugees in Central and Eastern Europe}}\\[0.5cm]
Mariia
\end{center}

The inflow of more than 8 million Ukrainian refugees into Europe has introduced both challenges and opportunities for labour market outcomes. People fleeing the war in Ukraine are allowed to live and work in the European Union for up tp 3 years under the Temporary Protection Status. Although the education and qualification levels of Ukrainian refugees are generally high, difficulties such as lack of language skills, childcare services and credential recognition processes pose significant barriers to employment. Instances of ethnic discrimination in the labor market have been reported, highlighting additional challenges faced by Ukrainian refugees (Londar et al., 2024). According to Preut, expanding language courses, childcare services, and accelerating credential recognition can enhance employment likelihood (Preut, 2023).

**Demographics**

Across all countries, the 35–59 age group dominates the refugee population, highlighting a significant presence of individuals in their prime working years. The 18–34 group follows, while the 60+ demographic is least represented. Estonia stands out with a particularly high share of people aged 18-34, while balancing distribution between young and middle-aged adults.

```{r, include=FALSE, warning=FALSE}

# Load necessary packages
if (!require('pacman')) install.packages('pacman'); library('pacman')
pacman::p_load(viridis, tidyverse, ggplot2, lubridate, knitr, dplyr, ggpubr, 
              janitor, tidyr, kableExtra, ggcorrplot, ggthemes, zoo, forcats,
              gridExtra, grid, Hmisc, FSA, dunn.test, readxl, RColorBrewer,
              patchwork, cowplot, pROC, rms)
# Load data
data_ee <- readRDS("Data/data_ee")
combined_df <- readRDS("Data/combined_df")
reasons_country_ee <- readRDS("Data/reasons_country_ee")
combined_data <- readRDS("Data/combined_data")
```

```{r, fig.height = 3, fig.width=8, echo=FALSE}
combined_data |>
  filter(!is.na(introduction_resp_age), !is.na(country)) |>
  mutate(introduction_resp_age = factor(introduction_resp_age,
                                levels = c("18-34", "35-59", "60+"))) |>
  count(country, introduction_resp_age) |>
  group_by(country) |>
  mutate(Percent = n / sum(n) * 100) |>
  ggplot(aes(x = country, y = Percent, fill = introduction_resp_age)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  labs(
    x = "Country",
    y = "Percent of Respondents",
    fill = "Age Group",
    title = "Age Distribution of Respondents by Country"
  ) +
  theme_minimal() +
  theme(
    legend.position = "right",
    axis.text.y = element_text(size = 10),
    plot.title = element_text(hjust = 0.5)
  ) +
  guides(fill = guide_legend(title.position = "top", title.hjust = 0.5)) +
  scale_fill_brewer(palette = "Dark2")

```

**Education**

Educational attainment varies, but most refugees possess at least secondary education. In Estonia, nearly half of the respondents (49.46%) hold vocational or specialized training, followed by 38% with a Bachelor's or Master's degree. Across all countries, the proportion of individuals with a Bachelor’s degree hovers between 10–20%, while Master's degrees are particularly common in Slovakia and Romania.

```{r, fig.height = 6, fig.width=8, warning=FALSE, echo=FALSE}

combined_data |>
  filter(!country %in% c("Hungary", "Bulgaria", "construct", NA)) |>
  mutate(demographics_educ_level = case_when(
    grepl("tech", demographics_educ_level, 
          ignore.case = TRUE) ~ "Technical",
    grepl("sec", demographics_educ_level, 
          ignore.case = TRUE) ~ "Secondary",
    grepl("pri", demographics_educ_level, 
          ignore.case = TRUE) ~ "Primary",
    grepl("phd", demographics_educ_level, 
          ignore.case = TRUE) ~ "PhD",
    grepl("master", demographics_educ_level, 
          ignore.case = TRUE) ~ "Master's",
    grepl("bachelor", demographics_educ_level, 
          ignore.case = TRUE) ~ "Bachelor's",
    grepl("no_edu", demographics_educ_level, 
          ignore.case = TRUE) ~ "No Education",
    grepl("prefer", demographics_educ_level, 
          ignore.case = TRUE) ~ "No Answer",
    grepl("spec", demographics_educ_level, 
          ignore.case = TRUE) ~ "Specialization",
    TRUE ~ demographics_educ_level
  )) |>
  filter(!is.na(demographics_educ_level) & 
           demographics_educ_level != "No Answer") |>
  count(country, demographics_educ_level) |>
  group_by(country) |>
  mutate(prop = n / sum(n) * 100) |>
  arrange(desc(prop), .by_group = TRUE) |>
    slice_head(n = 5) |>
    ungroup() |>
  ggplot(aes(x = reorder(demographics_educ_level, -prop), 
             y = prop, fill = demographics_educ_level)) +
  geom_col() +
  facet_wrap(~country, scales = "free_x") +
  xlab("Education Level") +
  ylab("Percent") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.8, size = 6)) +
  guides(fill = guide_legend(title = "Education Level")) +
  scale_fill_brewer(palette = "Dark2")

```

Although few hold PhDs, their presence is most visible in Slovakia. Notably, technical and vocational training is prevalent, suggesting that many refugees were skilled laborers—yet challenges remain in transferring those skills to host-country labor markets.

**Employment and Economic Participation**

Before displacement, employment rates among Ukrainian refugees were high (60–70%), regardless of host country. However, after resettlement, the picture changes dramatically. Employment drops while unemployment, housekeeping, and studying rise sharply - particularly in Romania, Slovakia, and Poland, where about one-third of refugees are now unemployed.

```{r, fig.height = 3.5, fig.width=8, echo=FALSE, warning=FALSE}

act_host <- combined_data |>
  filter(
    !is.na(host_country_work_coa),
    !country %in% c("Hungary", "Bulgaria", "construct", NA)
  ) |>
  count(country, host_country_work_coa) |>
  group_by(country) |>
  mutate(percent = n / sum(n) * 100) |>
  ggplot(aes(x = country, y = percent, 
             fill = fct_infreq(host_country_work_coa))) +
  geom_col() +
  xlab("Country") +
  ggtitle("Host Country Activities") +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45,  hjust = 0.8, size = 6),
    legend.position = "right"
  ) +
  guides(fill = guide_legend(title = "Activity")) +
  scale_fill_brewer(palette = "Dark2") + 
  theme(legend.position = "none") + ylab(NULL)

act_ukr <- combined_data|>
  filter(
    !is.na(host_country_work_coa),
    !country %in% c("Hungary", "Bulgaria", "construct", NA)
  ) |>
  filter(!is.na(demographics_resp_activity), 
         demographics_resp_activity != "No Answer") |>
  count(country, demographics_resp_activity) |>
  group_by(country) |>
  mutate(percent = n / sum(n) * 100) |>
  ggplot(aes(x = country, y = percent, 
             fill = demographics_resp_activity)) +
  geom_col(position = "stack") +
  xlab("Country") +
  ylab("Percent") +
  ggtitle("Employment Activity in Ukraine") +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45,  hjust = 0.8, size = 6),
    legend.position = "right"
  ) +
  guides(fill = guide_legend(title = "Activity Type")) +
  scale_fill_brewer(palette = "Dark2") + theme(legend.position = "none")

shared_legend <- get_legend(act_host + theme(legend.position = "right"))

combined_plot <- plot_grid(
  act_ukr, act_host,
  labels = NULL,
  ncol = 2,
  align = "hv"
)
plot_grid(
  combined_plot, shared_legend,
  ncol = 2,  
  rel_widths = c(0.5, 0.2)
)
```

Several barriers explain this shift. Language emerges as a prominent obstacle, especially in Estonia (cited by ~37% of respondents). Meanwhile, Moldova and Slovakia report higher rates of respondents experiencing no employment difficulties. Other commonly cited barriers include "Not looking for work" and insufficient opportunities, suggesting both personal and structural factors at play.

```{r, fig.height = 6, fig.width=8, echo=FALSE}

#Aggregated data

combined_df |>
  filter(!Country %in% c("Hungary", "Bulgaria", "construct", NA)) |>
    filter(Source == "job") |>
    mutate(Percent = round(Total_Proportion * 100, 2)) |>
    select(Component, Percent, Country) |>
    group_by(Country) |>
    arrange(desc(Percent), .by_group = TRUE) |>
    slice_head(n = 5) |>
    ungroup() |> 
  ggplot(aes(x = reorder(Component, -Percent), 
             y = Percent, fill = Component)) +
  geom_col(show.legend = TRUE) +
  facet_wrap(~Country, scales = "free_x") +
  xlab("Income Source") + ylab("Percent") +
  ggtitle("Problems with Finding Employment") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45,  hjust = 1, size = 6)) +
  guides(fill = guide_legend(title = "Reasons")) +
  scale_fill_brewer(palette = "Dark2")
```

**Income Sources**

Employment in the host country is the leading source of income across the board, especially in Estonia, Czechia, and Slovakia - where it exceeds 40–50%. Romania is an outlier, showing an even distribution among host-country jobs and alternative sources. Poland sees higher-than-average reliance on remittances.

```{r, fig.height = 6, fig.width=8, echo=FALSE}

#Aggregated data

combined_df |>
    filter(Source == "income") |>
    mutate(Percent = round(Total_Proportion * 100, 2))|>
    select(Component, Percent, Country) |>
    group_by(Country) |>
    arrange(desc(Percent), .by_group = TRUE) |>
    slice_head(n = 5) |>
    ungroup() |> 
  ggplot(aes(x = reorder(Component, -Percent), 
             y = Percent, fill = Component)) +
  geom_col(show.legend = TRUE) +
  facet_wrap(~Country, scales = "free_x") +
  xlab("Income Source") + ylab("Percent") +
  ggtitle("Comparison of Reported Income Sources by Country") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45,  hjust = 1, size = 6)) +
  guides(fill = guide_legend(title = "Income Source"))+
  scale_fill_brewer(palette = "Dark2")

```

Still, income insecurity remains a concern. Romania reports the highest number of refugees with no income, and in all countries, "No income" and "No answer" responses, though generally low, suggest hidden economic vulnerability.

**Aid and Social Protection** 

Cash benefits are the most widespread form of aid, reaching nearly 90% of respondents in countries like Czechia, Moldova, and Romania. Poland differs drastically: over 80% of respondents there receive family grants instead. Estonia presents a more diverse profile, with both cash and unemployment grants being common.

```{r, fig.height = 5, fig.width=8, echo=FALSE}
combined_df |>
  filter(!Country %in% c("Hungary", "Bulgaria", "construct", NA)) |>
    filter(Source == "benefits") |>
    mutate(Percent = round(Total_Proportion * 100, 2)) |>
    select(Component, Percent, Country) |>
    group_by(Country) |>
    arrange(desc(Percent), .by_group = TRUE) |>
    slice_head(n = 5) |>
    ungroup() |> 
  ggplot(aes(x = reorder(Component, -Percent), 
             y = Percent, fill = Component)) +
  geom_col(show.legend = TRUE) +
  facet_wrap(~Country, scales = "free_x") +
  xlab("Income Source") + ylab("Percent") +
  ggtitle("Social Protection Benefits from Host Country") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45,  hjust = 0.8, size = 6)) +
  guides(fill = guide_legend(title = "Type")) +
  scale_fill_brewer(palette = "Dark2")
```

Despite variations, the data underscores the central role of direct financial assistance in refugee support systems. However, the limited role of unemployment or disability benefits raises concerns about longer-term inclusion in formal welfare systems.

**Estonia graphs for popular article**

```{r}
# Filter & recode activities in Estonia
act_host_data <- combined_data |>
  filter(
    country == "Estonia",
    !is.na(host_country_work_coa)
  ) 

# Count and calculate percentage
act_host_summary <- act_host_data |>
  count(host_country_work_coa, name = "n_host") |>
  mutate(percent_host = round(n_host / sum(n_host) * 100, 1))


# Filter & recode activities in Ukraine
act_ukr_data <- combined_data |>
  filter(
    country == "Estonia",
    !is.na(demographics_resp_activity),
    demographics_resp_activity != "No Answer"
  ) 

# Count and calculate percentage
act_ukr_summary <- act_ukr_data |>
  count(demographics_resp_activity, name = "n_ukr") |>
  mutate(percent_ukr = round(n_ukr / sum(n_ukr) * 100, 1))


# Merge summaries for comparison
activity_comparison <- full_join(
  act_ukr_summary,
  act_host_summary,
  by = c("demographics_resp_activity" = "host_country_work_coa")
)

activity_comparison
```

```{r, fig.height = 4, fig.width=7, echo=FALSE}
combined_df |>
  filter(!Country %in% c("Hungary", "Bulgaria", "construct", NA)) |>
    filter(Source == "needs", Country == "Estonia") |>
  mutate(Component = fct_recode(Component,
    "Жилье" = "Accommodation",
    "Обучение" = "Education",
    "Трудоустройство" = "Employment",
    "Медицина" = "Healthcare",
    "Никаких" = "None",
  )) |>
    mutate(Percent = round(Total_Proportion * 100, 2)) |>
    select(Component, Percent, Country) |>
    group_by(Country) |>
    arrange(desc(Percent), .by_group = TRUE) |>
    slice_head(n = 5) |>
    ungroup() |>
  ggplot(aes(x = reorder(Component, Percent), 
             y = Percent, fill = Component)) +
  geom_col(show.legend = TRUE) +
  geom_text(aes(label = paste0(Percent, "%")), 
            hjust = -0.1, size = 3) +
  coord_flip() +
  xlab("Нужды") + ylab("Проценты") +
  ggtitle("Социально-экономические потребности украинцев") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
         legend.position = "none"
        ) +
  guides(fill = guide_legend(title = "Type")) +
  scale_fill_brewer(palette = "Dark2") +
  scale_y_continuous(expand = expansion(mult = c(0, 0.15)))
```

```{r, fig.height = 4, fig.width=6.7, echo=FALSE}

act_host <- combined_data |>
  filter(
    !is.na(host_country_work_coa),
    country == "Estonia"
  ) |>
  mutate(host_country_work_coa = factor(host_country_work_coa))|>
  mutate(host_country_work_coa = fct_recode(
  host_country_work_coa,
  "Работал(-а)" = "Employed",
  "Учился(-ась)" = "Studying",
  "Занимался(-ась) домом" = "Housekeeping",
  "Стажер" = "Trainee",
  "Вышел(-ла) на пенсию" = "Retired",
  "Нетрудоустроенный(-ая)" = "Unemployed",
  "Болезнь или травма" = "Long term illness/injury",
  "Другое" = "Other"
))|>
  count(country, host_country_work_coa) |>
  mutate(percent = n / sum(n) * 100) |>
  ggplot(aes(x = country, y = percent, fill = host_country_work_coa)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  theme(axis.text.x = element_blank(), axis.title.x = element_blank()) +
  guides(fill = guide_legend(title = "Тип деятельности")) +
  scale_fill_brewer(palette = "Dark2") +
  theme(legend.position = "none") +
  ylab(element_blank()) +
  ggtitle( " ",
    subtitle = "Занятость в Эстонии"
  )

act_ukr <- combined_data |>
  filter(
    country == "Estonia"
  ) |>
  mutate(demographics_resp_activity = fct_recode(
  demographics_resp_activity,
  "Работал(-а)" = "Employed",
  "Учился(-ась)" = "Studying",
  "Занимался(-ась) домом" = "Housekeeping",
  "Стажер" = "Trainee",
  "Вышел(-ла) на пенсию" = "Retired",
  "Нетрудоустроенный(-ая)" = "Unemployed",
  "Болезнь или травма" = "Long term illness/injury",
  "Другое" = "Other"
))|>
  filter(!is.na(demographics_resp_activity), demographics_resp_activity != "No Answer") |>
  count(country, demographics_resp_activity) |>
  mutate(percent = n / sum(n) * 100) |>
  ggplot(aes(x = country, y = percent, fill = demographics_resp_activity)) +
  geom_bar(stat = "identity") +
  ylab("Проценты") +
  theme_minimal() +
  theme(axis.text.x = element_blank(), axis.title.x = element_blank()) +
  guides(fill = guide_legend(title = "Activity Type")) +
  scale_fill_brewer(palette = "Dark2") +
  theme(legend.position = "none" )+
  ggtitle(
    "Рабочая активность украинцев до и после переезда в Эстонию (2023)",
    subtitle = "Занятость в Украине"
  )

# Shared legend
shared_legend <- get_legend(
  act_host + theme(legend.position = "right")
)

# Combined plot
combined_plot <- plot_grid(
  act_ukr, act_host,
  labels = NULL,
  ncol = 2,
  align = "hv"
)

plot_grid(
  combined_plot, shared_legend,
  ncol = 2,
  rel_widths = c(0.19, 0.1)
)

```

```{r, fig.width=7, fig.height=5, warning=FALSE, echo==FALSE}

combined_data |>
  filter(
    country == "Estonia",
    !is.na(demographics_educ_level),
    !is.na(introduction_resp_age)
  ) |>
  mutate(demographics_educ_level = case_when(
    grepl("tech", demographics_educ_level, ignore.case = TRUE) ~ "Техническое",
    grepl("sec", demographics_educ_level, ignore.case = TRUE) ~ "Среднее",
    grepl("pri", demographics_educ_level, ignore.case = TRUE) ~ "Начальное",
    grepl("phd", demographics_educ_level, ignore.case = TRUE) ~ "Докторантура",
    grepl("master", demographics_educ_level, ignore.case = TRUE) ~ "Магистратура",
    grepl("bachelor", demographics_educ_level, ignore.case = TRUE) ~ "Бакалавриат",
    grepl("no_edu", demographics_educ_level, ignore.case = TRUE) ~ "Без образования",
    grepl("prefer", demographics_educ_level, ignore.case = TRUE) ~ "Без ответа",
    grepl("spec", demographics_educ_level, ignore.case = TRUE) ~ "Специализация",
    TRUE ~ demographics_educ_level
  )) |>
  filter(demographics_educ_level != "Без ответа") |>
  count(introduction_resp_age, demographics_educ_level) |>
  group_by(introduction_resp_age) |>
  mutate(prop = n / sum(n) * 100) |>
  ungroup() |>
  mutate(demographics_educ_level = fct_reorder(demographics_educ_level, n, .fun = sum, .desc = TRUE)) |>
  ggplot(aes(x = introduction_resp_age, y = prop, fill = demographics_educ_level)) +
  geom_col(position = "stack") +
  xlab("Возраст") +
  ylab("Проценты") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  guides(fill = guide_legend(title = "Уровень образования")) +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Уровень образования по возрастным группам украинцев в Эстонии (2023)")


make_prop_table(data_ee$demographics_educ_level)

```

```{r, fig.height = 4, fig.width=7, echo=FALSE}

#Aggregated data

combined_df |>
  filter(Country == "Estonia", Source == "job") |>
  mutate(Component = fct_recode(Component,
    "Языковой барьер" = "Language barrier",
    "Нет препятствий" = "None",
    "Недостаток возможностей" = "Insuffisient opportunities",
    "Непризнание квалификаций" = "Lack of recognition",
    "Другое" = "other",
    "Не планирую оставаться" = "not_staying",
    "Уход за другими" = "Care for others",
    "Нет разрешения на работу" = "lack_permit",
    "Дискриминация" = "discrim",
    "Потеря пособий" = "loss_benefits",
    "Предпочитаю не отвечать" = "prefer_no_answer",
    "Нет адреса" = "lack_address",
    "Нет информации" = "lack_info",
    "Нет документов" = "lack_docum"
  )) |>
  mutate(Percent = round(Total_Proportion * 100, 2)) |>
  select(Component, Percent, Country) |>
  group_by(Country) |>
  arrange(desc(Percent), .by_group = TRUE) |>
  slice_head(n = 5) |>
  ungroup() |> 
  ggplot(aes(x = reorder(Component, Percent), 
             y = Percent, fill = Component)) +
  geom_col(show.legend = TRUE) +
  geom_text(aes(label = paste0(Percent, "%")), 
            hjust = -0.1, size = 3) +
  xlab("Причина") + 
  ylab("Проценты") +
  ggtitle("Основные препятствия для трудоустройства украинцев") +
  theme_minimal() +
  coord_flip() +
  theme(axis.text.x = element_text(angle = 35,  hjust = 1, size = 6),
        legend.position = "none") +
  scale_fill_brewer(palette = "Dark2")+
  scale_y_continuous(expand = expansion(mult = c(0, 0.15)))

```

```{r, fig.height = 4, fig.width=7, echo=FALSE}

#Aggregated data

combined_df |>
  filter(Country == "Estonia", Source == "cohesion") |>
   mutate(Component = fct_recode(Component,
    "Вербальная агрессия" = "verbal_aggression",
    "Никаких" = "none",
    "Негатив в соцсетях" = "comments_social_media",
    "Дискриминация" = "discriminatory_behavior",
    "Другое" = "other"
  )) |>
  mutate(Percent = round(Total_Proportion * 100, 2)) |>
  select(Component, Percent, Country) |>
  group_by(Country) |>
  arrange(desc(Percent), .by_group = TRUE) |>
  slice_head(n = 5) |>
  ungroup() |> 
  ggplot(aes(x = reorder(Component, Percent), 
             y = Percent, fill = Component)) +
  geom_col(show.legend = TRUE) +
  geom_text(aes(label = paste0(Percent, "%")), 
            hjust = -0.1, size = 3) +
  xlab("Тип препятствия") + 
  ylab("Проценты") +
  ggtitle("Основные проявления дискриминации и социальной изоляции") +
  theme_minimal() +
  coord_flip() +
  theme(axis.text.x = element_text(angle = 35,  hjust = 1, size = 6),
        legend.position = "none") +
  scale_fill_brewer(palette = "Dark2")+
  scale_y_continuous(expand = expansion(mult = c(0, 0.15)))

```

```{r, fig.height = 4, fig.width=7, echo=FALSE}

#Aggregated data

combined_df |>
    filter(Source == "income", Country == "Estonia") |>
  mutate(Component = fct_recode(Component,
    "Работа" = "Job",
    "Социальная защита" = "Social Protection",
    "Нет дохода" = "No income",
    "Другие источники" = "Other Sources",
    "Социальная защита в Украине" = "Social Protection from Ukraine"
  )) |>
    mutate(Percent = round(Total_Proportion * 100, 2))|>
    select(Component, Percent, Country) |>
    group_by(Country) |>
    arrange(desc(Percent), .by_group = TRUE) |>
    slice_head(n = 5) |>
    ungroup() |> 
  ggplot(aes(x = reorder(Component, Percent), 
             y = Percent, fill = Component)) +
   geom_col(show.legend = TRUE) +
  geom_text(aes(label = paste0(Percent, "%")), 
            hjust = -0.1, size = 3) +
  xlab("Источник дохода") + ylab("Проценты") +
  ggtitle("Источники дохода украинцев в Эстонии") +
  theme_minimal() +
  coord_flip() +
  theme(axis.text.x = element_text(angle = 35,  hjust = 1, size = 6),
        legend.position = "none") +
  scale_fill_brewer(palette = "Dark2")+
  scale_y_continuous(expand = expansion(mult = c(0, 0.15)))

```

```{r}

# Function to create a clean proportion table
make_prop_table <- function(variable, na.rm = FALSE) {
  if (na.rm) {
    variable <- variable[!is.na(variable)]
  }

  tab <- table(variable)
  
  tibble::tibble(
    Category = names(tab),
    Count = as.numeric(tab),
    Percent = round(100 * prop.table(tab), 2)
  )
}

rus_labels <- c(
  "dont_know" = "Затрудняюсь ответить",
  "fewer" = "Меньше, чем до войны",
  "more" = "Больше, чем до войны",
  "prefer_not_to_answer" = "Предпочитаю не отвечать",
  "same" = "Примерно столько же"
)

# Generate and format table
make_prop_table(data_ee$economic_capicity_L13_SS_AFF_GOODS, na.rm = TRUE) |>
 mutate(Category = rus_labels[Category]) |>
  kable(booktabs = TRUE, align = "c",
        col.names = c("Ответ", "Количество", "Процент"))|>
  kable_styling(latex_options = c("striped"), font_size = 12) |>
  column_spec(1, bold = TRUE) |>
  row_spec(0, bold = TRUE, color = "white", background = "gray") |>
  add_header_above(c("Способность приобретать товары по сравнению с довоенным временем" = 3))

make_prop_table(data_ee$economic_capicity_L13_1_SM_MORE_GOODS)
make_prop_table(data_ee$economic_capicity_L13_1_SM_LESS_GOODS)
```


```{r}
ggplot(data_ee, aes(x = host_country_healthcare_access, 
                             fill = host_country_healthcare_access)) +
  geom_bar(stat = "count") +
  xlab("Problems accessing Healthcare Services") +
  ylab("Count") +
  scale_fill_brewer(palette = "Paired") + gg

combined_df |>
  filter(Source == "med_issues") |>
  mutate(Percent = round(Total_Proportion * 100, 2)) |>
  select(Component, Percent) |>
  arrange(desc(Percent))

```
